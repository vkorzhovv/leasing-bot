<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Статистика</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f4;
        }
        h1 {
            text-align: center;
        }
        table {
            margin: 20px auto;
            border-collapse: collapse;
            width: 80%;
            max-width: 800px;
            background-color: white;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
        }
        th, td {
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        tr:hover {
            background-color: #e0e0e0;
        }
    </style>
</head>
<body>
    <form method="get" action="">
        <label for="selected_month">Выберите месяц:</label>
        <select id="selected_month" name="month">
            <option value="1" {% if selected_month == "1" %}selected{% endif %}>Январь</option>
            <option value="2" {% if selected_month == "2" %}selected{% endif %}>Февраль</option>
            <option value="3" {% if selected_month == "3" %}selected{% endif %}>Март</option>
            <option value="4" {% if selected_month == "4" %}selected{% endif %}>Апрель</option>
            <option value="5" {% if selected_month == "5" %}selected{% endif %}>Май</option>
            <option value="6" {% if selected_month == "6" %}selected{% endif %}>Июнь</option>
            <option value="7" {% if selected_month == "7" %}selected{% endif %}>Июль</option>
            <option value="8" {% if selected_month == "8" %}selected{% endif %}>Август</option>
            <option value="9" {% if selected_month == "9" %}selected{% endif %}>Сентябрь</option>
            <option value="10" {% if selected_month == "10" %}selected{% endif %}>Октябрь</option>
            <option value="11" {% if selected_month == "11" %}selected{% endif %}>Ноябрь</option>
            <option value="12" {% if selected_month == "12" %}selected{% endif %}>Декабрь</option>
        </select>
        <button type="submit">Показать статистику</button>
    </form>

    <p></p>

    <form method="get" action="{% url 'download_excel' %}">
        <label for="selected_month">Выберите месяц:</label>
        <select id="selected_month" name="month">
            <option value="1" {% if selected_month == "1" %}selected{% endif %}>Январь</option>
            <option value="2" {% if selected_month == "2" %}selected{% endif %}>Февраль</option>
            <option value="3" {% if selected_month == "3" %}selected{% endif %}>Март</option>
            <option value="4" {% if selected_month == "4" %}selected{% endif %}>Апрель</option>
            <option value="5" {% if selected_month == "5" %}selected{% endif %}>Май</option>
            <option value="6" {% if selected_month == "6" %}selected{% endif %}>Июнь</option>
            <option value="7" {% if selected_month == "7" %}selected{% endif %}>Июль</option>
            <option value="8" {% if selected_month == "8" %}selected{% endif %}>Август</option>
            <option value="9" {% if selected_month == "9" %}selected{% endif %}>Сентябрь</option>
            <option value="10" {% if selected_month == "10" %}selected{% endif %}>Октябрь</option>
            <option value="11" {% if selected_month == "11" %}selected{% endif %}>Ноябрь</option>
            <option value="12" {% if selected_month == "12" %}selected{% endif %}>Декабрь</option>
        </select>
        <button type="submit">Скачать статистику</button>
    </form>

    <h1>Пользовательский охват опроса</h1>
    <table>
        <tr>
            <th>Опрос</th>
            <th>Скольким пользователям отправлено</th>
        </tr>
        {% for entry in entries %}
            <tr>
                <td>{{ entry.poll.title }}</td>
                <td>{{ entry.users_count }}</td>
            </tr>
        {% endfor %}
    </table>

    <h1>Пользовательский охват поста</h1>
    <table>
        <tr>
            <th>Пост</th>
            <th>Скольким пользователям отправлено</th>
        </tr>
        {% for entry in posts_entries %}
            <tr>
                <td>{{ entry.post.text }}</td>
                <td>{{ entry.users_count }}</td>
            </tr>
        {% endfor %}
    </table>

    <h1>Просмотры актуального/Новости</h1>
    <table>
        <tr>
            <th>Актуальное/Новость</th>
            <th>Тип</th>
            <th>Сколько просмотров</th>
        </tr>
        {% for entry in storynews_entries %}
            <tr>
                <td>{{ entry.item.name }}</td>
                <td>{{ entry.item.sort }}</td>
                <td>{{ entry.views }}</td>
            </tr>
        {% endfor %}
    </table>

    <h1>Просмотры товаров</h1>
    <table>
        <tr>
            <th>Товар</th>
            <th>Категория</th>
            <th>Сколько просмотров</th>
        </tr>
        {% for entry in products_entries %}
            <tr>
                <td>{{ entry.product.name }}</td>
                <td>{{ entry.product.category }}</td>
                <td>{{ entry.views }}</td>
            </tr>
        {% endfor %}
    </table>

    <h1>Просмотры категорий</h1>
    <table>
        <tr>
            <th>Категория</th>
            <th>Сколько просмотров</th>
        </tr>
        {% for entry in categories_entries %}
            <tr>
                <td>{{ entry.category.get_level2.0|join:" > "|default:"" }}>{{ entry.category.name }}</td>
                <td>{{ entry.views }}</td>
            </tr>
        {% endfor %}
    </table>

</body>
</html>
